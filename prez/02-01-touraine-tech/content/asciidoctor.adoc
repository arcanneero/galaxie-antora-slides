[state=h_background clavier]
= Asciidoc(tor)

image::images/asciidoc.png[width=20%]

üê¶ @asciidoctor

[NOTE.speaker]
====
[G]
Utilis√© par des gros projets : hibernate / fedora

Spec Asciidoc : Vient d'int√©grer la fondation Eclipse (7 Janvier 2019)
====

== Pourquoi cet outil ?

De nos constats...

[NOTE.speaker]
====
[N] Volont√© d'aller vers la doc as code.
De rapprocher la doc du code (dans les d√©p√¥ts git)

Deux vrai possibilit√© : Markdown vs Asciidoctor
====

== !

Une faiblesse qui peut √™tre une force

[NOTE.speaker]
====
[G] ::
- Quelques simplicit√© syntaxiques
- Gestion dans un Git
- Pas de probl√®me de flavours (spec Asciidoc)
- Insertion de fragment de fichier
- Syntaxe plus coh√©rente
- Les devs ont les droits !
====

== Parce que la doc ce n'est pas toujours un long fleuve tranquille...

[NOTE.speaker]
====
[G]

La doc as code, ca pose quand m√™me des probl√®mes qu'on a pas autrement...
====

[state=v_background nappes]
==  Build & deploy

[NOTE.speaker]
====
[N] En Ruby, mais...

Accessible √† tous, grace √† JRuby ou JS (merci au transpiler http://opalrb.com/)
====

==  Build

```groovy
buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.3'
        classpath 'org.asciidoctor:asciidoctorj-pdf:1.5.0-alpha.15'
    }
}
```

[NOTE.speaker]
====
[N]

Mise en place de build avec Graddle :::
- Syntaxe ulta simple
- G√©n√©ration de PDF
====

==  Build

```groovy

asciidoctor {
    backends 'html5', 'pdf'
    dependsOn clean
    sourceDir = file('src/asciidoc')
    sources {
        include '**/*.adoc'
        exclude '**/content/**'
    }
    resources {
        from (sourceDir) {
            include '**/resources/**'
        }
    }
    outputDir = file('build/docs')
}
```

==  Deploy

Le Dockerfile le plus compliqu√© du monde

```
FROM nginx

COPY build/docs/html5 /usr/share/nginx/html
```

[NOTE.speaker]
====
[G]

D√©ploiement Continue - Jenkins / Docker / NginX
====

==  Mais nos d√©p√¥ts deviennent bord√©liques

image::images/sacdenoeuds.jpg[]

[NOTE.speaker]
====
Mais nos d√©p√¥ts deviennent bord√©liques
====

[state=v_background neurone]
==  Une structuration partag√©e

[NOTE.speaker]
====
[N]

- Plusieurs projets sur un plateau
- Pourquoi ne pas avoir une base commune ?
- Ce sont finalement les m√™mes questqion qu'avec une doc traditionnelle
====

== !

image::images/structure.png[width=80%]

[NOTE.speaker]
====
* D√©marrage - Quickstart
* Environnements - Environements
* Recommandation - Guidlines
* Manuels - How to

Mais c'est une doc orient√© produit.
Il y a d'autre besoins dans la vie d'un projet.
====

== !

image::images/structure-2.png[width=80%]

== Et si on avait plusieurs d√©p√¥ts ?

[NOTE.speaker]
====
[N]

Comment la probl√©matique d'agr√©gation a √©t√© prise en compte :::
- D√©pot sous format zip des √©l√©ments g√©n√©r√©s
- Mise en place d'aggr√©garteur via Dockerfile (sch√©mas)
====

== !

image::images/dockers.svg[width=80%]

== !

image::images/docker.svg[width=80%]

== !

image::images/pipeline.svg[]

== !

image::images/pipelines.svg[width=80%]